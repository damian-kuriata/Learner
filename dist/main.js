(()=>{"use strict";var t,e=new Uint8Array(16);function r(){if(!t&&!(t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(e)}const s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,n=function(t){return"string"==typeof t&&s.test(t)};for(var a=[],o=0;o<256;++o)a.push((o+256).toString(16).substr(1));const i=function(t,e,s){var o=(t=t||{}).random||(t.rng||r)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e){s=s||0;for(var i=0;i<16;++i)e[s+i]=o[i];return e}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(a[t[e+0]]+a[t[e+1]]+a[t[e+2]]+a[t[e+3]]+"-"+a[t[e+4]]+a[t[e+5]]+"-"+a[t[e+6]]+a[t[e+7]]+"-"+a[t[e+8]]+a[t[e+9]]+"-"+a[t[e+10]]+a[t[e+11]]+a[t[e+12]]+a[t[e+13]]+a[t[e+14]]+a[t[e+15]]).toLowerCase();if(!n(r))throw TypeError("Stringified UUID is invalid");return r}(o)};class l{constructor(t,e,r=null){this.originalText=t,this.translatedText=e,this.id=r??i().toString().substr(0,5)}checkTranslation(t,e){if((t=t.toLowerCase().trim()).replaceAll("ä","ae"),t.replaceAll("ö","oe"),t.replaceAll("ü","ue"),t.replaceAll("ß","ss"),"to"!==e&&"from"!==e)throw new Error("Wrong direction");let r=this;return r.translatedText=r.translatedText.toLowerCase().trim(),r.translatedText.replaceAll("ä","ae"),r.translatedText.replaceAll("ö","oe"),r.translatedText.replaceAll("ü","ue"),r.translatedText.replaceAll("ß","ss"),r.originalText=r.originalText.toLowerCase().trim(),r.originalText.replaceAll("ä","ae"),r.originalText.replaceAll("ö","oe"),r.originalText.replaceAll("ü","ue"),r.originalText.replaceAll("ß","ss"),"to"===e?t===r.originalText:t===r.translatedText}static localStorageTag="learner_data";static loadFromStorage(t=!0,e=null){let r=JSON.parse(localStorage.getItem(l.localStorageTag));if(!r||0===r.length)return[];let s=r;if(s instanceof Array==0)throw new Error("Data must be array!");let n=s.map((t=>new l(t.originalText,t.translatedText,t.id)));if(t)return n;if(e)return n.find((t=>t.id===e));const a=n.length;return n[Math.floor(Math.random()*(a-0)+0)]}static saveToStorage(t){if(!(t instanceof l))throw new Error("Instance of Phrase required!");let e=l.loadFromStorage(),r=!1;for(let s=0;s<e.length;s++)e[s].id===t.id&&(e[s].originalText=t.originalText,e[s].translatedText=t.translatedText,r=!0);r||e.push(t);let s=JSON.stringify(e);localStorage.setItem(l.localStorageTag,s)}static removeFromStorage(t){let e=l.loadFromStorage(),r=e.findIndex((e=>e.id===t));if(-1===r)throw new Error("Phrase not found");e.splice(r,1),localStorage.setItem(l.localStorageTag,JSON.stringify(e))}}class c{constructor(t){this.listElement=t,this.refresh(l.loadFromStorage())}refresh(t){for(this.phrases=t;this.listElement.firstChild;)this.listElement.removeChild(this.listElement.firstChild);this.phrases.forEach(((t,e)=>{let r=document.createElement("li");const s=t.id;r.setAttribute("id","phrase"+s),r.innerHTML=`\n        <div>\n          <span style="font-weight: bold">${e}. </span>\n          <span>${t.originalText}</span>\n        </div>\n      `;const n=document.createElement("button");n.classList.add("editButton"),n.setAttribute("id","edit"+s),n.addEventListener("click",(()=>{console.log("edit")})),n.textContent="Edit";const a=document.createElement("button");a.classList.add("deleteButton"),a.setAttribute("id","delete"+s),a.addEventListener("click",(()=>{if(this.onPhraseDelete){const t=a.getAttribute("id").slice(6);console.log("Trying to delete: ",t),this.onPhraseDelete(t)}})),a.textContent="X",a.setAttribute("aria-label","Delete phrase"),r.appendChild(n),r.appendChild(a),this.listElement.appendChild(r)}))}}let h=document.querySelector("#learnBtn"),d=document.querySelector("#manageBtn"),u=(document.querySelector("#checkBtn"),document.querySelector("#learnPane")),p=(document.querySelector("#managePane"),new class{constructor(t){this.pane=t,this.shouldLoadNext=!1,this.currentPhrase=null,this.translationDirection,this.translatedPhrase=document.querySelector("#translatedPhrase"),this.learnPhraseInput=document.querySelector("#learnPhraseInput"),this.resultText=document.querySelector("#resultText"),this.checkButton=document.querySelector("#checkBtn"),this.checkButton.addEventListener("click",(()=>{this.checkInput()})),this.nextButton=document.querySelector("#nextButton"),this.nextButton.addEventListener("click",(()=>{this.processOnePhrase()}))}processOnePhrase(){if(this.shouldLoadNext=!1,this.nextButton.classList.add("nodisplay"),this.learnPhraseInput.value="",this.resultText.textContent="",this.translationDirection=Math.floor(2*Math.random())+0,this.translationDirection=0===this.translationDirection?"to":"from",this.currentPhrase=l.loadFromStorage(!1),console.log("Current: ",this.currentPhrase),this.currentPhrase===[])return this.resultText.textContent="At first add phrases!",void(this.currentPhrase=null);"to"===this.translationDirection?this.translatedPhrase.textContent=this.currentPhrase.translatedText:this.translatedPhrase.textContent=this.currentPhrase.originalText}stopLearning(){currentPhrase=null}checkInput(){let t=this.learnPhraseInput.value;this.currentPhrase.checkTranslation(t,this.translationDirection)?this.#t():this.#e()}#t(){this.resultText.textContent="Correct",this.resultText.classList.add("feedbackCorrect"),setTimeout(this.processOnePhrase,2e3)}#e(){this.resultText.textContent="Wrong, correct answer: ","to"===this.translationDirection?this.resultText.textContent+=this.currentPhrase.originalText:this.resultText.textContent+=this.currentPhrase.translatedText,this.resultText.classList.add("feedbackTryAgain"),this.nextButton.classList.remove("nodisplay"),this.nextButton.classList.add("displayBlock"),this.shouldLoadNext=!0}show(){this.pane.classList.remove("inactivePane")}hide(){this.pane.classList.add("inactivePane")}}(u)),g=new class{constructor(t){this.pane=t,this.phraseList=new c(document.querySelector("#phrasesList")),this.phraseList.onPhraseDelete=t=>{l.removeFromStorage(t),this.phraseList.refresh(l.loadFromStorage())},this.newButton=document.querySelector("#managePane > button"),this.newButton.addEventListener("click",(()=>{console.log("New")}))}show(){this.pane.classList.remove("inactivePane"),console.log("Storage: ",l.loadFromStorage()),this.phraseList.refresh(l.loadFromStorage())}hide(){this.pane.classList.add("inactivePane")}}(managePane);h.addEventListener("click",(()=>{p.show(),g.hide(),h.classList.add("activeNavBtn"),d.classList.remove("activeNavBtn"),p.processOnePhrase()})),d.addEventListener("click",(()=>{g.show(),p.hide(),d.classList.add("activeNavBtn"),h.classList.remove("activeNavBtn")})),p.processOnePhrase()})();